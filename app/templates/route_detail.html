{%- extends "base-layout.html" %}
{%- from "partials/helper_macros.html" import get_cercanias_line_icon, print_station_route_map with context %}
{%- block app_content %}
	
	<section id="line-route" class="line-route app-main-content" aria-label="Ruta de la línea {{ route.route_long_name if route else '' }}">
			<div class="grouped-lists-scroll">
						<div class="app-block-padding sticky-title">
							<h2 class="app-block-title">➜ {{ route.route_short_name }} · {{ route.route_long_name }}
								<span class="title-badge cercanias-badge"><img alt="Cercanías" src="/static/img/icon-cercanias.svg"></span>
							</h2>
						</div>
						<div class="app-block-padding">
							<ul class="grid-route-map" data-number-of-stations="{{ route.stations|length }}" style="--number-of-stations: {{ route.stations|length }}; --line-color: {{ route.color_bg }};">
								{% for stop in route.stations %}
									<li class="grid-route-map-station {{ 'origin-station' if route.origin.stop_id == stop.stop_id else 'destination-station' if route.destination.stop_id == stop.stop_id else 'mid-station' }}">
										{{ print_station_route_map(stop) }}
									</li>
								{% endfor %}
							</ul>
						</div>
				
				
						<h2 class="text-xl font-semibold mb-2">Trenes circulando en esta ruta</h2>

						{% if not trains or trains|length == 0 %}
						<p>No se encuentran trenes circulando en esta línea ahora mismo.</p>
						{% else %}
						<table border="1" cellpadding="6" cellspacing="0">
							<thead>
							<tr>
								<th>Tren</th>
								<th>Estado</th>
								<th>Parada actual</th>
							</tr>
							</thead>
							<tbody>
							{% for t in trains %}
								<tr>
									<td><a href="/trains/{{ nucleus.slug }}/{{ t.train_id }}">{{ t.train_id }}</a></td>
									<td>{{ t.status_human() }}</td>
									<td>{{ repo.get_stop_name(t.stop_id) }} <i>({{ t.stop_id or "—" }})</i></td>
								</tr>
							{% endfor %}
							</tbody>
						</table>
		</div>
	{% endif %}
	
	
	
	
	</section>
{%- endblock %}
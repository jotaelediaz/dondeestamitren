<header>
	<a href="/alpha/stations/{{ nucleus.slug }}">&larr; Volver a estaciones de {{ nucleus.name }}</a>
	<h1>{{ station.name }}</h1>
	<ul>
		<li><strong>Núcleo:</strong> {{ nucleus.name }}</li>
		<li class="coords"><strong>Coordenadas:</strong> {{ '%.5f'|format(station.lat) }}, {{ '%.5f'|format(station.lon) }}</li>
	</ul>
</header>

<section>
	<h2>Rutas que dan servicio a esta estación</h2>
	{% if serving_lines %}
		<ul>
			{% for l in serving_lines %}
				<li>
					<a href="/alpha/lines/{{ nucleus.slug }}/{{ l.line_id }}">{{ l.line.short_name }} <i>({{ l.line_id }})</i></a>
				</li>
			{% endfor %}
		</ul>
	{% else %}
		<p>No hay líneas asociadas.</p>
	{% endif %}
</section>


<h2 class="text-xl font-semibold mb-2">Trenes que paran en esta estación</h2>

{% if not live_trains or live_trains|length == 0 %}
	<p>No se encuentran trenes que paren en esta estación ahora mismo.</p>
{% else %}
	<table border="1" cellpadding="6" cellspacing="0">
		<thead>
		<tr>
			<th>Tren</th>
			<th>Ruta</th>
			<th>Destino</th>
			<th>Estado</th>
			<th>Parada actual</th>
			<th>Posición</th>
		</tr>
		</thead>
		<tbody>
		{% for t in live_trains %}
			<tr>
				<td><a href="/alpha/trains/{{ nucleus.slug }}/{{ t.train_id }}">{{ t.train_id }}</a></td>
				<td>{{ t.route_id }}</td>
				<td>→ {{repo.get_stop_name(repo.route_destination(t.route_id)) or '—' }}</td>
				<td>{{ t.status_human() }}</td>
				
				
				<td>{{ repo.get_stop_name(t.stop_id) }} <i>({{ t.stop_id or "—" }})</i></td>
				<td>
					{% if t.lat and t.lon %}
						{{ '%.5f'|format(t.lat) }}, {{ '%.5f'|format(t.lon) }}
					{% else %}—{% endif %}
				</td>
			</tr>
		{% endfor %}
		</tbody>
	</table>
{% endif %}


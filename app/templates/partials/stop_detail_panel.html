
<div class="stop-detail">
	<header class="bottom-card-modal-header">
		<h1 id="stop-modal-title">{{ stop.name }}</h1>
	</header>
	
	<section>
		<p>➜ <a href="/stations/{{ nucleus.slug }}/{{ stop.station_id | urlencode }}">Ver ficha de estación</a></p>
		
		<h2>Tren más cercano a la parada</h2>
		{% if nearest_train %}
			<div class="nearest-train-card chip-card" style="--train-color: {{ route.color_bg }}">
				<div class="chip-body">
					<div class="chip-title">
						<strong>{{ nearest_train.train.train_id }}</strong>
					</div>
					<div class="chip-subtitle">
						{% if nearest_train.approaching %}
							a {{ nearest_train.delta_seq }} parada{{ 's' if nearest_train.delta_seq|int != 1 else '' }}
							(~{{ '%.1f'|format(nearest_train.delta_km) }} km)
						{% else %}
							ya pasó esta parada ({{ '%.1f'|format(nearest_train.abs_delta_km) }} km)
						{% endif %}
						{% if nearest_train.physical_d_km is not none %}
							· geodésica: ~{{ '%.1f'|format(nearest_train.physical_d_km) }} km
						{% endif %}
					</div>
					{% if eta %}
						<div class="nearest-train-eta">
							Llega en ~{{ eta.minutes_rounded }} min
							<span class="muted">· {{ '%.1f'|format(eta.distance_km) }} km · v≈{{ '%.0f'|format(eta.speed_kmh_used) }} km/h · {{ eta.stops_remaining }} paradas</span>
						</div>
					{% endif %}
				</div>
			</div>
		{% endif %}
	</section>
</div>

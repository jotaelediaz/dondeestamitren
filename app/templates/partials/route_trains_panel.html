{% if not trains %}
	<p>No se encuentran trenes circulando en esta línea ahora mismo.</p>
{% else %}
	<ul class="train-list grouped-lists-scroll-horizontal">
		{% for t in trains %}
			{% set train_route = repo.get_by_route_and_dir(t.route_id, dir) or repo.get_by_route_and_dir(t.route_id, "") %}
			<li class="route-train-chip-card chip-card" style="--train-color: {{ train_route.color_bg }};">
				<a
					href="/trains/{{ nucleus.slug }}/{{ t.train_id }}"
					hx-get="/trains/{{ nucleus.slug }}/{{ t.train_id }}"
					hx-target="#main"
					hx-swap="innerHTML transition:true"
					hx-push-url="true"
					hx-on="htmx:beforeRequest:
                 const layer = document.getElementById('stop-details-modal');
                 if (layer) layer.outerHTML = '<div id=stop-details-modal></div>';">
					<div class="route-train-chip-header">
						<div class="route-train-chip-icon chip-icon"><i class="material-symbols-rounded" aria-hidden="true">train</i></div>
						<h4 class="train-name chip-name">Tren {{ t.train_id }}</h4>
					</div>
					<div class="route-train-chip-body">
						<span class="route-train-chip-stop-name">{{ repo.get_stop_name(t.stop_id) or t.stop_id or '—' }}</span>
					</div>
				</a>
			</li>
		{% endfor %}
	</ul>
	<p class="muted">Actualizado: {{ last_snapshot }}</p>
{% endif %}
